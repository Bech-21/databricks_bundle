# databricks.yml - Main bundle configuration file
bundle:
  name: bundleproject

# Include resource definitions
include:
  - resources/**/*.yml

# Variables that can be used across configs
variables:
  catalog_name:
    description: "Catalog name for the project"
    default: earth_data

# Target environments
targets:
  # Development environment
  dev:
    mode: development
    default: true
    workspace:
      host: https://dbc-fd4c8a5f-6584.cloud.databricks.com/
     
    resources:
      pipelines:
        pipeline_pl_earthquake_rig_data_dlt:
          development: true
          name: pl_earthquake_rig_data_dlt_dev
          catalog: ${var.catalog_name}
          # Remove permissions block to avoid conflicts
      jobs:
        Earthquake_rig_job:
          name: Earthquake_rig_job_dev
          # Remove permissions block to avoid conflicts
  
  # UAT environment  
  uat:
    mode: development
    workspace:
      host: https://dbc-fd4c8a5f-6584.cloud.databricks.com/
    resources:
      pipelines:
        pipeline_pl_earthquake_rig_data_dlt:
          development: false
          name: pl_earthquake_rig_data_dlt_uat
          catalog: ${var.catalog_name}_uat
      jobs:
        Earthquake_rig_job:
          name: Earthquake_rig_job_uat
  
  # Production environment
  prod:
    mode: production
    workspace:
      host: https://dbc-fd4c8a5f-6584.cloud.databricks.com/
    # Use run_as to avoid permission issues
    run_as:
      user_name: bachirmahomad@gmail.com
    resources:
      pipelines:
        pipeline_pl_earthquake_rig_data_dlt:
          development: false
          name: pl_earthquake_rig_data_dlt_prod
          catalog: ${var.catalog_name}
          channel: CURRENT
          # Explicitly set no custom permissions
          permissions: []
      jobs:
        Earthquake_rig_job:
          name: Earthquake_rig_job_prod
          # Explicitly set no custom permissions
          permissions: []